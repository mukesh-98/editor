/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x267d43 from'@ckeditor/ckeditor5-core/src/command';import{getStyles as _0x291df2,getConverterOptions as _0x2af683}from'./utils';export default class c extends _0x267d43{constructor(_0x20f9b){super(_0x20f9b),this['set']('isBusy',!0x1);}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x5e6a3d={}){const _0x2b96d5=this['editor'],t=_0x2b96d5['t'],_0x43cf40=_0x5e6a3d['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert';return this['isBusy']=!0x0,this['refresh'](),_0x291df2(_0x5e6a3d['stylesheets']||['EDITOR_STYLES'])['then'](_0x34c148=>{const _0x14f048={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x2b96d5['locale']['contentLanguageDirection']+'\x22>'+_0x2b96d5['getData']()+'</div>','css':_0x34c148,'options':{..._0x5e6a3d['converterOptions'],..._0x2af683(_0x2b96d5)}},_0x417d65={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x5e6a3d['token']&&{'Authorization':_0x5e6a3d['token']['value']}},'body':JSON['stringify'](_0x14f048)};return window['fetch'](_0x43cf40,_0x417d65)['then'](_0x3f071d=>{if(0xc8!==_0x3f071d['status'])throw _0x3f071d;return _0x3f071d['blob']();})['then'](_0x2da04b=>{this['o'](_0x2da04b,_0x5e6a3d['fileName']||'document.docx');});})['catch'](_0x44cf4b=>{throw _0x2b96d5['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x44cf4b;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x1714ee,_0x2cb602){const _0x46f410=document['createElement']('a');_0x46f410['href']=window['URL']['createObjectURL'](_0x1714ee),_0x46f410['download']=_0x2cb602,_0x46f410['click'](),_0x46f410['remove']();}}